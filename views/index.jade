extends layout

block content
   if(matches!=null && matches.length > 0)
      #matches                     
      div(style="padding-left: 20px; min-height:100%")
         - image = "/images/"+matches[0].image + ".png"
         img(src=image alt=matches[0].image class="player")
         h1!= title
         p Please make your predictions below & get closer to your fun prize!
            - now = (new Date(now)).getTime()
            - count = 0
            - predicted = false
            - predictedteam = ''
            - scoretyp = ''
            - scorehemma = ''
            - background = 'background:rgba(0, 0, 0, 0);'
            - flagtyp = ''
            - flaghemma = ''
            - each match in matches
               - matchdate = (new Date(match.datum)).getTime()
               - predicted = false
               - scoretyp = ''
               - scorehemma = ''
               - background = 'background:rgba(0, 0, 0, 0);'
               - flagtyp = "/images/" + match.typ + "_flag.png"
               - flaghemma = "/images/" + match.hemma + "_flag.png"
               - betpoints = 0
               - count++
               - if(betsMade != null)
                  - each bet in betsMade
                     - if(bet.bet == match.bet)
                        - predicted = true
                        - predictedteam = bet.predictedteam
                        - background = 'background:rgba(163, 29, 189, 0.52);'
                        - scoretyp = bet.scoretyp
                        - scorehemma = bet.scorehemma
                        - betpoints = bet.points

                  div(id="ctl00_Div2" style="padding:20px;margin:20px; width:auto;"+background class="container").match
                     if moment(matchdate).diff(moment(now)) < 0
                        img(src="/images/logo.png" alt="Predicted" class="logo")
                     h1
                        - if(bet)
                           span(class="test")!= bet.scorehemma
                        img(src=flagtyp alt="" style="border-width:0px;" class="flag")
                        span!= match.typ + '  '
                        input(id="typ" + match.bet name="typ"+match.bet value=scoretyp type="text" placeholder="_" class="input-xlarge search-query score" maxlength="1" onchange="javascript:$(this).parent().parent().find('.scoretyp').val($(this).val())")
                        span!= ' v '
                        input(id="hemma" + match.bet name="hemma" + match.bet value=scorehemma type="text" placeholder="_" class="input-xlarge search-query score" maxlength="1" onchange="javascript:$(this).parent().parent().find('.scorehemma').val($(this).val())")
                        span!= '  ' + match.hemma
                        img(src=flaghemma alt="" style="border-width:0px;" class="flag")
                     fieldset
                        p
                           if(match.grupp != 'X')
                              div.group!= '<b>Group:</b> ' + match.grupp
                           div.date!= '<b>Date:</b> ' + moment(match.datum).format('LLL')
                           if(match.resultat != null && match.resultat != '')
                              div.results!= 'This game has ended and the result is <b>' + match.resultat + '</b>.'
                              if(predicted && betpoints != null)
                                 div.points!= 'You have earned <b>' + betpoints + '</b> points.'

                           if predicted && !placesuccess
                              if predictedteam != 'none'
                                 div.prediction!= '<br/>You have predicted <b>' + predictedteam + '</b> as the winner! '
                              else
                                 div.prediction!= '<br/>You have predicted this match to end in a <b>tie</b>?! '
               
                        if placesuccess == count
                           div(class="alert alert-success")!= successmessage
                        if error
                           div(class="alert alert-success")!= message
               
                        div
                        form(method="post" id="predict")
                           input(name="user" type="hidden" value=''+user)
                           input(name="position" class="position" id="position" type="hidden" value=count)
                           input(name="typ" class="typ" id="typ" type="hidden" value=match.typ)
                           input(name="hemma" class="hemma" id="hemma" type="hidden" value=match.hemma)
                           input(name="scoretyp" class="scoretyp" id="scoretyp" type="hidden" value=scoretyp)
                           input(name="scorehemma" class="scorehemma" id="scorehemma" type="hidden" value=scorehemma)
                           input(name="bet" class="bet" id="bet" type="hidden" value=match.bet)
                           if moment(matchdate).diff(moment(now)) >= 0
                              div(class="buttons")
                                 input(type="submit" class="button predictBtn" value="Predict!")
 
    else if state == 'rest'
       div(style="padding-left: 20px; min-height:100%")
          div(id="ctl00_Div2" style="padding:20px;background:rgba(0, 0, 0, 0);border:none;margin:20px; width:auto" class="container").match
             h1!= title
             img(src="/images/armadillo.png" class="player armadillo")
             p!= "Today is a rest day. There are no matches. However you can always: <br/><br/><span style='text-align:center'>Make your predictions with the <a href='/calendar'  style='font-weight:bold'>Calendar</a></span><br/><span style='text-align:center'>Check <a href='/ranking' style='font-weight:bold'>Your Ranking</a>!</span>"              
     else if state == 'notstarted'
       div(style="padding-left: 20px; min-height:100%")
          div(id="ctl00_Div2" style="padding:20px;background:rgba(0, 0, 0, 0);border:none;margin:20px; width:auto" class="container").match
             h1!= title
             img(src="/images/armadillo.png" class="player armadillo")
             p!= "The World Cup in Brazil has not started yet! <br/>Please come back on <span style='color:red; font-weight:bold'>" + moment(startdate).format('LL') + "</span> and make your predictions!!"              
     else if state == 'ended'
       div(style="padding-left: 20px; min-height:100%")
          div(id="ctl00_Div2" style="padding:20px;background:rgba(0, 0, 0, 0);border:none;margin:20px; width:auto" class="container").match
             h1!= title
             img(src="/images/trophy.png" class="player armadillo")
             p!= "Thank <span style='font-weight:bold; color:#36185F'>YOU</span> for participating in this epic event! <br/>Make sure to check the <a href='/ranking'> ranking results</a> before you log out! We had so much fun playing together :)"              
               
    div(class="footer" style="margin-top:20px;")
       div(style="padding:5px;")
          img(src="/images/map.png", alt="Netlight", style="border-width:0px; width: 50px")
          